---
- hosts: nzxt
  become: yes

  vars_files:
    - vars/nzxt.yml

  tasks:
  - name: Ensure booted from install media
    fail:
      msg: "Not booted from Arch install media"
    when: ansible_nodename != 'archiso'
    tags:
      - exit_early
  - name: Update the system clock
    command: timedatectl set-ntp true
    tags:
    - sync_clock
  - name: Repartition install drive
    block:
      - name: Wipe install drive and all its partitions
        command: find /dev -wholename "{{ install_drive }}*" -exec wipefs --force --all {} \;
        tags:
          - wipefs
